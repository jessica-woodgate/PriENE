pygame 2.6.1 (SDL 2.32.54, Python 3.11.12)
Hello from the pygame community. https://www.pygame.org/contribute.html
What type of scenario do you want to run ['colours', 'capabilities', 'allotment']: What run do you want to test (select 200_days to replicate results in the paper) ['current_run', '50_days', '200_days']: What mix of society do you want to test ['homogeneous', 'heterogeneous']: What type of agent do you want to implement ['baseline', 'utilitarian', 'maximin', 'egalitarian', 'average', 'majoritarian', 'veto', 'optimist', 'all']: How many agents do you want to implement (select 4 to replicate results in the paper) ['2', '4', '6', '20', '50', '100']: How many allotments do you want? (select 2 to replicate results in the paper) (must be more than 0 and less than 21): Do you want to write data to file? (y, n): data will be written into data/results/current_run.
Do you want to write norms to file? (y, n): norms will be written into data/results/current_run.
Do you want to render the simulation? (y, n): wandb: Currently logged in as: jessica-woodgate to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /lus/lfs1aip1/home/b5v/jwoodgate.b5v/PriENE/wandb/run-20250815_010806-ak06frvk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run zany-armadillo-55
wandb: ‚≠êÔ∏è View project at https://wandb.ai/jessica-woodgate/PriENE
wandb: üöÄ View run at https://wandb.ai/jessica-woodgate/PriENE/runs/ak06frvk
Traceback (most recent call last):
  File "/home/b5v/jwoodgate.b5v/PriENE/run.py", line 241, in <module>
    run_all(scenario,society_mix,run_name,num_agents,NUM_BERRIES,num_allocations,MAX_WIDTH,MAX_HEIGHT,max_episodes,max_days,training,write_data,write_norms,render,log_wandb,wandb_project)
  File "/home/b5v/jwoodgate.b5v/PriENE/run.py", line 131, in run_all
    create_and_run_model(scenario,society_mix,run_name,num_agents,num_start_berries,num_allocations,agent_type,max_width,max_height,max_episodes,max_days,training,write_data,write_norms,render,log_wandb,wandb_project)
  File "/home/b5v/jwoodgate.b5v/PriENE/run.py", line 118, in create_and_run_model
    model_inst = AllotmentHarvest(society_mix,num_agents,num_start_berries,num_allocations,agent_type,max_width,max_height,max_episodes,max_days,training,checkpoint_path,write_data,write_norms,file_string)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lus/lfs1aip1/home/b5v/jwoodgate.b5v/PriENE/src/scenarios/allotment_harvest.py", line 23, in __init__
    self._init_agents(society_mix, agent_type, checkpoint_path)
  File "/lus/lfs1aip1/home/b5v/jwoodgate.b5v/PriENE/src/scenarios/allotment_harvest.py", line 64, in _init_agents
    self._add_agent(id, agent_type, allotment, checkpoint_path, allocation_id=allocation_id)
  File "/lus/lfs1aip1/home/b5v/jwoodgate.b5v/PriENE/src/harvest_model.py", line 197, in _add_agent
    a = HarvestAgent(i,self,agent_type,allotment,self.training,checkpoint_path,self.epsilon,self.write_norms,shared_replay_buffer=self.shared_replay_buffer,allocation_id=allocation_id)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lus/lfs1aip1/home/b5v/jwoodgate.b5v/PriENE/src/agent/harvest_agent.py", line 41, in __init__
    self.decision_module = DQNDecisionModule(agent_type,unique_id,training,self.actions,self.n_features,checkpoint_path,epsilon,shared_replay_buffer)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lus/lfs1aip1/home/b5v/jwoodgate.b5v/PriENE/src/agent/modules/dqn_decision_module.py", line 20, in __init__
    self._init_networks(checkpoint_path)
  File "/lus/lfs1aip1/home/b5v/jwoodgate.b5v/PriENE/src/agent/modules/dqn_decision_module.py", line 65, in _init_networks
    self.q_network = DQN(self.actions,(self.n_features,),self.training,checkpoint_path=self.q_checkpoint_path,shared_replay_buffer=self.shared_replay_buffer)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lus/lfs1aip1/home/b5v/jwoodgate.b5v/PriENE/src/agent/dqn/dqn.py", line 55, in __init__
    self.dqn = keras.models.load_model(self.checkpoint_path,compile=True, custom_objects={"NNetwork": NNetwork})
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b5v/jwoodgate.b5v/miniforge3/envs/PriENE/lib/python3.11/site-packages/keras/src/saving/saving_api.py", line 189, in load_model
    return saving_lib.load_model(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b5v/jwoodgate.b5v/miniforge3/envs/PriENE/lib/python3.11/site-packages/keras/src/saving/saving_lib.py", line 367, in load_model
    return _load_model_from_fileobj(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/b5v/jwoodgate.b5v/miniforge3/envs/PriENE/lib/python3.11/site-packages/keras/src/saving/saving_lib.py", line 482, in _load_model_from_fileobj
    raise ValueError(
ValueError: Expected a model.weights.h5 or model.weights.npz file.
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mzany-armadillo-55[0m at: [34mhttps://wandb.ai/jessica-woodgate/PriENE/runs/ak06frvk[0m
[1;34mwandb[0m: Find logs at: [1;35m../../../../lus/lfs1aip1/home/b5v/jwoodgate.b5v/PriENE/wandb/run-20250815_010806-ak06frvk/logs[0m
